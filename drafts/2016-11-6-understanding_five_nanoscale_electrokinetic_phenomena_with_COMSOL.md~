---
layout: post
title: Understanding five electrokinetic phenomena in nanopores with COMSOL
category: Science, Physics
comments: True
---

COMSOL is a software application that allows you to simulate different types of physics using something called the [finite element method](https://en.wikipedia.org/wiki/Finite_element_method), or FEM. The basic idea behind FEM is that you take the system that you want to understand, break it down into many smaller parts, solve the relevant equations in each part, and stitch the solutions together at the end. This allows you to solve really complex physical situations that can't be handled analytically. There are people (programmers, physicists) that spend their whole academic careers developing these methods, and others, the 'consumers', that are just concerned with getting answers. COMSOL is great for the latter camp because it does not require extensive knowledge about the FEM method to get started.

One thing I think COMSOL is useful for is gaining an intuition about processes that aren't very easily understandable. In this post I'll talk about 5 interesting phenomena surrounding my area of research, nanopores, using COMSOL. Data was generated entirely from COMSOL, and the plots are a mix of some taken from COMSOL, and others made using Python and matplotlib.

# 1. The electrical double layer
The EDL is the basis for everything whacky and counter intuitive that occurs in nanopores. When a charged surface comes in contact with a conducting medium, like electrolyte solution, free charges in the medium will redistribute to screen the charge of the surface. More specifically, charges of the same polarity (coions) are repelled from the surface while charges of the opposite polarity (counterions) are attracted. This screening layer is known as the electrical double layer, and typically ranges between 0.1 and 10 nm. The EDL can greatly influence the behavior of a system, especially in nanoscale systems where the total volume within 1 nm of a charged surface is significant. Another interesting thing to point out is that the 'importance' of surface effects scales like $1/R$, where R is the system size (e.g. diameter). One way to see this is to plot the volume fraction that is within $\lambda_{D}$ as a function of system size, as in the plot below. 

The plot shows that even at $\sim 20$ nm, the EDL is still only a small fraction of the total volume. However, past that point the fraction within $\lambda_{D}$ rises sharply.

Debye-Hückel theory predicts the ion and potential distributions in the vicinity of the charged surface, under the assumptions that the surface's electric potential are not too large and that ion-ion correlations can be ignored. Here are the equations for the ion charge and electric potential:


And here's a plot showing how the ion concentrations change in the vicinity of a charged surface according to Debye-Hückel.



Some key things to highlight:
1. The concentration of counterions (ions of the opposite charge polarity of the surface) is greater than bulk concentration in the EDL
2. Coions (ions of the same charge polarity) are reduced in number in the EDL
3. From 1. and 2. it follows that the **the solution has a net charge near the charged surface**
3. The *total* ion concentration remains equal to the bulk everywhere
3. Concentrations and electric potential exponentially approach their bulk values as we move away from the charged surface, with a characteristic decay length known as the 'Debye length' $\lambda_{\text{D}}$. Another important parameter is the $\zeta$-potential ('zeta'), the electric potential at the surface's slip plane, which is effectively a measure of the surface's charge.
4. $lambda_{\text{D}}$ is independent of the surface charge value, but depends on the bulk ion concentration--larger bulk ion concentration screens the surface charge over a small distance.

That's all there is to the EDL according to Debye-Hückel, but let's see if COMSOL can confirm what we already know.

# 2. Electroosmosis
Electroosmosis is when water flows in an electrical field. This effect is surprising, since water is a neutral molecule and in a constant electric field shouldn't experience any force. The explanation from the effect comes from the EDL. Ions migrate in an electric field, and drag water molecules along with them. In the bulk, positive and negative ions move in opposite directions, so their is no net flow of water. However, as we've just seen there *is* a net charge polarity in the EDL, and due to the charge imbalance there, there is similarly a drag imbalance that can cause the net motion of water. This is electroosmosis. What's interesting is that this effect doesn't exist only in the EDL, but extends into the bulk.

# 3. Ion current saturation
If we connect two large, electrolyte reservoirs with a constricted channel we effectively have the ionic equivalent of an electronic resistor circuit. The reservoirs play the role of wires and the constricted channel the resistor. Applying a voltage across the constriction will generate an ionic current, with its magnitude determined by the conductance properties of the resistor. If the constriction is nano-sized, then the conductance of the resistor is influenced by the conductance properties of the EDL, due to surface charges on the channel surface. One interesting thing about this is that if we reduce the ion concentration we expect the total conductance of the resistor to drop as well. Less charges, less current. But, if the entire volume of the nanochannel is filled with EDL, then this drop cannot occur since the total charge still has to be screened! As a result, there is a threshold concentration below which reducing the bulk ion concentration does not reduce the conductance of the channel. This is known as ion current saturation, and occurs when an EDL 'overlap' occurs, where the EDL's of opposite sides of the channel overlap.

To demonstrate this, let's calculate IV curves of a simulated cylindrical nanochannel using COMSOL for a range of ion concentrations. We can calculate the resistance R from the slope of each IV curve and plot it against the ion concentration. We should find an approximately linear relationship until the saturation point, at which point the resistance does not change with any further reduction in the ion concentration.

We can also 

# 4. Ion current rectification

Ion current rectification (ICR) refers to a difference in nanopore conductance at opposite voltage polarities, which looks something like this in an IV curve:

In order for ICR to occur, the pore's symmetry has to be broken


